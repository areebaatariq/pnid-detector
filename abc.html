
    <html>
    <head>
        <title>P&ID Detection Interactive Demo</title>
    </head>
    <body>
        <h2>P&ID Detection Interactive Demo</h2>
        <div id="container" style="position:relative; display:inline-block;">
            <img id="pid-image" src="/static/result_0d595a82c3454de294655eb68b2e20d6.png" />
        </div>
        <script>
            const container = document.getElementById('container');
            const img = document.getElementById('pid-image');
            const detections = [{"id": "2 WAY VALVE-01", "class": "2 WAY VALVE", "bbox": [611, 195, 681, 235], "color": [107, 9, 99]}, {"id": "SPECIAL PIPING ITEM-01", "class": "SPECIAL PIPING ITEM", "bbox": [727, 135, 806, 209], "color": [27, 41, 43]}, {"id": "SPECIAL PIPING ITEM-02", "class": "SPECIAL PIPING ITEM", "bbox": [1316, 241, 1396, 315], "color": [27, 41, 43]}, {"id": "FIELD INSTRUMENT-01", "class": "FIELD INSTRUMENT", "bbox": [998, 118, 1082, 202], "color": [27, 123, 113]}, {"id": "FIELD INSTRUMENT-02", "class": "FIELD INSTRUMENT", "bbox": [687, 228, 731, 278], "color": [27, 123, 113]}, {"id": "FIELD INSTRUMENT-03", "class": "FIELD INSTRUMENT", "bbox": [486, 31, 573, 117], "color": [27, 123, 113]}, {"id": "2 WAY VALVE-02", "class": "2 WAY VALVE", "bbox": [1259, 247, 1306, 317], "color": [107, 9, 99]}, {"id": "GATE VALVE-01", "class": "GATE VALVE", "bbox": [750, 399, 792, 460], "color": [50, 131, 109]}, {"id": "SPECIAL PIPING ITEM-03", "class": "SPECIAL PIPING ITEM", "bbox": [1017, 303, 1091, 381], "color": [27, 41, 43]}, {"id": "ANGLE RELIEF VALVE-01", "class": "ANGLE RELIEF VALVE", "bbox": [1121, 159, 1158, 246], "color": [112, 84, 29]}, {"id": "REVISION TRIANGLE-01", "class": "REVISION TRIANGLE", "bbox": [1230, 385, 1285, 428], "color": [102, 66, 0]}, {"id": "FIELD INSTRUMENT-04", "class": "FIELD INSTRUMENT", "bbox": [846, 85, 887, 129], "color": [27, 123, 113]}, {"id": "SPECIAL PIPING ITEM-04", "class": "SPECIAL PIPING ITEM", "bbox": [766, 33, 832, 96], "color": [27, 41, 43]}, {"id": "SPECIAL PIPING ITEM-05", "class": "SPECIAL PIPING ITEM", "bbox": [1302, 120, 1376, 182], "color": [27, 41, 43]}, {"id": "FIELD INSTRUMENT-05", "class": "FIELD INSTRUMENT", "bbox": [1116, 361, 1158, 403], "color": [27, 123, 113]}, {"id": "REVISION TRIANGLE-02", "class": "REVISION TRIANGLE", "bbox": [578, 125, 620, 171], "color": [102, 66, 0]}, {"id": "REVISION TRIANGLE-03", "class": "REVISION TRIANGLE", "bbox": [1188, 122, 1243, 168], "color": [102, 66, 0]}, {"id": "REVISION TRIANGLE-04", "class": "REVISION TRIANGLE", "bbox": [570, 259, 621, 305], "color": [102, 66, 0]}, {"id": "CONCENTRIC REDUCER-01", "class": "CONCENTRIC REDUCER", "bbox": [1122, 426, 1157, 455], "color": [85, 8, 71]}, {"id": "REVISION TRIANGLE-05", "class": "REVISION TRIANGLE", "bbox": [818, 162, 865, 202], "color": [102, 66, 0]}, {"id": "ANGLE RELIEF VALVE-02", "class": "ANGLE RELIEF VALVE", "bbox": [691, 60, 739, 136], "color": [112, 84, 29]}, {"id": "CONCENTRIC REDUCER-02", "class": "CONCENTRIC REDUCER", "bbox": [691, 297, 726, 328], "color": [85, 8, 71]}, {"id": "REVISION TRIANGLE-06", "class": "REVISION TRIANGLE", "bbox": [1460, 242, 1504, 291], "color": [102, 66, 0]}, {"id": "REVISION TRIANGLE-07", "class": "REVISION TRIANGLE", "bbox": [1512, 126, 1554, 165], "color": [102, 66, 0]}, {"id": "REVISION TRIANGLE-08", "class": "REVISION TRIANGLE", "bbox": [996, 254, 1049, 300], "color": [102, 66, 0]}, {"id": "FIELD INSTRUMENT-06", "class": "FIELD INSTRUMENT", "bbox": [1410, 192, 1457, 232], "color": [27, 123, 113]}, {"id": "REVISION TRIANGLE-09", "class": "REVISION TRIANGLE", "bbox": [934, 37, 977, 79], "color": [102, 66, 0]}];

            img.onload = () => {
                const scaleX = img.width / img.naturalWidth;
                const scaleY = img.height / img.naturalHeight;

                detections.forEach(d => {
                    let box = document.createElement('div');
                    box.style.position = 'absolute';
                    box.style.left = (d.bbox[0] * scaleX) + 'px';
                    box.style.top = (d.bbox[1] * scaleY) + 'px';
                    box.style.width = ((d.bbox[2]-d.bbox[0]) * scaleX) + 'px';
                    box.style.height = ((d.bbox[3]-d.bbox[1]) * scaleY) + 'px';
                    box.style.border = '4px solid rgb(' + d.color[0] + ',' + d.color[1] + ',' + d.color[2] + ')';
                    box.style.cursor = 'pointer';
                    box.title = d.id;
                    box.onmouseover = () => {
                        let tooltip = document.createElement('div');
                        tooltip.innerText = d.id;
                        tooltip.style.position = 'absolute';
                        tooltip.style.background = 'rgba(0,0,0,0.7)';
                        tooltip.style.color = 'white';
                        tooltip.style.padding = '2px 5px';
                        tooltip.style.borderRadius = '3px';
                        tooltip.style.top = (d.bbox[1]*scaleY - 20) + 'px';
                        tooltip.style.left = (d.bbox[0]*scaleX) + 'px';
                        tooltip.id = 'tooltip_' + d.id.replace(/\s+/g, '');
                        container.appendChild(tooltip);
                    };
                    box.onmouseout = () => {
                        let t = document.getElementById('tooltip_' + d.id.replace(/\s+/g, ''));
                        if(t) t.remove();
                    };
                    container.appendChild(box);
                });
            };
        </script>
    </body>
    </html>
    